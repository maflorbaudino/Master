This is a master thesis code
